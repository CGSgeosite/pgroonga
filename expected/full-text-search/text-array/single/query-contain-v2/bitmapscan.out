CREATE TABLE memos (
  title text,
  contents text[]
);
INSERT INTO memos
     VALUES ('PostgreSQL',
             ARRAY['PostgreSQL is an OSS RDBMS',
                   'PostgreSQL has partial full-text search support']);
INSERT INTO memos
     VALUES ('Groonga', ARRAY['Groonga is an OSS full-text search engine',
                              'Groonga has full full-text search support']);
INSERT INTO memos
    VALUES ('PGroonga',
            ARRAY['PGroonga is an OSS PostgreSQL extension',
                  'PGroonga adds full full-text search support based on Groonga to PostgreSQL']);
CREATE INDEX pgroonga_memos_index ON memos
  USING pgroonga (contents pgroonga.text_array_full_text_search_ops_v2);
SET enable_seqscan = off;
SET enable_indexscan = off;
SET enable_bitmapscan = on;
EXPLAIN
SELECT title, contents
  FROM memos
 WHERE contents &?> Array['rdbms', 'groonga engine'];
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Bitmap Heap Scan on memos  (cost=0.00..4.01 rows=2 width=64)
   Recheck Cond: (contents &?> '{rdbms,"groonga engine"}'::text[])
   ->  Bitmap Index Scan on pgroonga_memos_index  (cost=0.00..0.00 rows=1 width=0)
         Index Cond: (contents &?> '{rdbms,"groonga engine"}'::text[])
(4 rows)

SELECT title, contents
  FROM memos
 WHERE contents &?> Array['rdbms', 'groonga engine'];
   title    |                                         contents                                          
------------+-------------------------------------------------------------------------------------------
 PostgreSQL | {"PostgreSQL is an OSS RDBMS","PostgreSQL has partial full-text search support"}
 Groonga    | {"Groonga is an OSS full-text search engine","Groonga has full full-text search support"}
(2 rows)

DROP TABLE memos;
